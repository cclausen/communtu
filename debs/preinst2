
    IFS="*"
    set +e
    # test if zenity is present
    zenity --version >/dev/null 2>&1
    if [ $? = 0 ]; then
      # if yes, display sources and keys to the user
      zenity --list --width 1000 --height 800 --title "Paketquellen hinzufügen" --text "Folgende Paketquellen und Schlüssel werden hinzugefügt" --column "Quelle" --column "Schlüssel" $SOURCESKEYS
      if [ $? != 0 ]; then
          # abort if the user does not confirm
          exit 1
      fi
    fi
    set -e
    
    # add sources
    APTLIST="/etc/apt/sources.list"
    echo "" >> $APTLIST
    echo "# Von Communtu hinzugefügte Quellen" >> $APTLIST
    for source in $SOURCES; do
    	URL=$( echo $source | cut -d " " -f 2 )
    	TYPE=$( echo $source | cut -d " " -f 3-6 )
    	set +e
    	# is source already present?
    	grep -q "$URL.*$TYPE" $APTLIST   
    	if [ "$?" != "0" ]; then
    	    # if not, add it
    		echo $source >> $APTLIST
    	fi
    	set -e
    done

    # add keys
    for key in $KEYS; do
    	set +e
        wget -q $key -O- | apt-key add -
    	if [ "$?" != "0" ]; then
    		echo "Konnte Schlüssel nicht installieren: "$key
    		exit 1
    	fi
    	set -e
    done
    IFS=" "
    
    # sync new sources
    # we get an error because we can't get the lock, but that does not matter
    apt-get update || true
    ;;

    abort-upgrade)
    ;;

    *)
        echo "preinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0


