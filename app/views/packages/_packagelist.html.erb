<%= render_flash %>

<%= form_tag('/packages/search', :method => "post") %>
<table>
<tr>
<td><%=t(:view_packages__packagelist_0)%></td>
<td>
    <select id="group" name="group" onchange="this.form.submit()">
        <option>all</option>
        <% groups.each do |group| %>
            <option <%= "selected='selected'" if (session[:group] == group.section) %>><%= group.section %></option>
        <% end %>
    </select>
</td>
<td width="100%"/></td>
<td width="50%"><%=t(:view_packages__packagelist_1)%></td>
<td>
     <%= check_box_tag("programs",1,session[:programs]) %>
</td>
<td width="100%"/></td>
<td><%=t(:view_packages__packagelist_2)%></td>
<td>
    <input type="textbox" id="search" name="search" value="<%= session[:search]%>"/>
</td>
</tr>
</table>
</form>

<div class="inner1">
<table width="100%" cellspacing="0">

<% if !packages.empty? then%>
<% for package in packages %>
<% css=cycle("packageList0", "packageList1") %>
  <tr> 
  	<td class="<%= css %>"> <%= package.icon(20)%>
  		<%= link_to(package.name, package_path(package), :title => t(:view_packages__packagelist_3)) %></td>
	<td class="<%= css %>" align="middle" valign="middle">
     <% if !package.stars.nil? %>
        <div class='star-rating-<%= css %>' style='width:<%= (package.stars * 18).to_i %>px; '> </div>
     <% end %>
	</td>
    <td class="<%= css %>" width="80" align="right">
        <%= link_to image_tag("/images/install.png", :size => "22x22", :border => "0", :title => t(:view_packages__packagelist_4), :alt => t(:view_packages__packagelist_4)), "apt://"+package.name %>                          
	    <%= link_to image_tag("/images/sources.jpg", :size => "22x22", :border => "0", :title => t(:view_packages__packagelist_6), :alt => t(:view_packages__packagelist_7)), "/users/#{current_user.id}/suggestion/install_package_sources/#{package.id}" %>
		<% if editing_metapackage? %>
		    
			<%= link_to_remote(image_tag("/images/add.png", :size => "22x22", :border => "0", :title =>t(:view_packages__packagelist_8), :alt => t(:view_packages__packagelist_8)), \
			        :url => user_path(current_user) + "/cart/add_to_cart/" + package.id.to_s,\
			        :update => 'meta_cart') %>
		<% end %>
    	<% if is_admin? %>
    		<%= link_to image_tag("/images/edit-delete.png", :size => "22x22", :border => "0", :title => t(:view_packages__packagelist_10), :alt => t(:view_packages__packagelist_10)),
    		        package_path(package), :confirm => t(:view_packages__packagelist_12), :method => :delete %>
			<% end %>
	</td>
  </tr>
<% end %>
<tr><td colspan="4" style="padding-top:15px"><%= paginating_links(packages, :window_size => 10) %></td></tr>
<% end %>
</table>
</div>
